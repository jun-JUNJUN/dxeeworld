{% extends "../base.html" %} {% block title %}ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿ - {{
company.get('name') or company.get('company_name') or 'ä¼æ¥­' }}{% end %} {%
block head %}
<style>
    .review-form-container {
        max-width: 90%;
        margin: 0 auto;
        padding: 20px;
    }

    .company-info-section {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border: 1px solid #dee2e6;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 32px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .company-name {
        font-size: 1.5rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 12px;
    }

    .company-location {
        color: #6c757d;
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .location-icon {
        color: #007bff;
    }

    /* ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤ºãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®æ”¹å–„ */
    .review-form {
        margin-top: 20px;
    }

    .form-section {
        margin-bottom: 32px;
        padding: 20px;
        background: #ffffff;
        border: 1px solid #e9ecef;
        border-radius: 8px;
    }

    .form-section-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #495057;
        margin-bottom: 16px;
        padding-bottom: 8px;
        border-bottom: 2px solid #f8f9fa;
    }

    .employment-status-section {
        background: #f8f9fa;
    }

    .review-categories .form-section {
        margin-bottom: 24px;
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-label {
        font-weight: 500;
        color: #495057;
        margin-bottom: 8px;
        display: block;
    }

    .form-control {
        border-radius: 6px;
        border: 1px solid #ced4da;
        padding: 10px 12px;
    }

    .form-control:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
    }

    .review-actions {
        margin-top: 32px;
        padding-top: 24px;
        border-top: 2px solid #e9ecef;
    }

    .btn {
        border-radius: 6px;
        padding: 12px 24px;
        font-weight: 500;
    }

    /* å‹¤å‹™æœŸé–“å…¥åŠ›æ©Ÿèƒ½ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .employment-period-section {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 24px;
    }

    .employment-period-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #495057;
        margin-bottom: 16px;
    }

    .period-inputs {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
    }

    .period-select {
        min-width: 120px;
        border-radius: 6px;
        border: 1px solid #ced4da;
        padding: 8px 12px;
        background-color: white;
    }

    .period-separator {
        font-weight: 500;
        color: #6c757d;
        margin: 0 4px;
    }

    @media (max-width: 576px) {
        .period-inputs {
            flex-direction: column;
            align-items: stretch;
        }

        .period-separator {
            text-align: center;
            margin: 8px 0;
        }

        .period-select {
            width: 100%;
        }
    }

    @media (max-width: 768px) {
        .review-form-container {
            max-width: 100%;
            padding: 15px;
        }

        .company-info-section {
            padding: 20px;
            margin-bottom: 24px;
        }

        .company-name {
            font-size: 1.3rem;
        }
    }
</style>
{% end %} {% block content %}
<div class="review-form-container">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card">
                <div class="card-header">
                    <h2 class="mb-0">ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿</h2>
                </div>
                <div class="card-body">
                    <!-- ä¼æ¥­æƒ…å ±ï¼ˆæ”¹å–„ç‰ˆï¼‰ -->
                    <div class="company-info-section">
                        <h4 class="company-name">{{ company.get('name') or company.get('company_name') or 'ä¼æ¥­åæœªè¨­å®š' }}</h4>
                        <p class="company-location">
                            <span class="location-icon">ğŸ“</span>
                            {% if company.get('location') %}
                                {{ company['location'].split(',')[0].strip() }}
                            {% else %}
                                æ‰€åœ¨åœ°æœªè¨­å®š
                            {% end %}
                        </p>
                    </div>

                    <!-- æœªèªè¨¼æ™‚ã®Mini Panelè¡¨ç¤º -->
                    {% if show_login_panel %}
                    <div class="alert alert-warning" role="alert">
                        <h5 class="alert-heading">ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™</h5>
                        <p>
                            ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æŠ•ç¨¿ã™ã‚‹ã«ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã¾ãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãŒå¿…è¦ã§ã™ã€‚
                        </p>
                        <hr />
                        <div class="d-flex gap-2">
                            <a
                                href="/login?redirect={{ handler.request.uri }}"
                                class="btn btn-primary"
                                >ãƒ­ã‚°ã‚¤ãƒ³</a
                            >
                            <a
                                href="/auth/email/register?redirect={{ handler.request.uri }}"
                                class="btn btn-outline-primary"
                                >æ–°è¦ç™»éŒ²</a
                            >
                        </div>
                    </div>
                    {% end %}

                    <!-- ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ  -->
                    {% if not show_login_panel %}
                    <form method="post" id="reviewForm">
                        {% module xsrf_form_html() %}

                        <!-- Task 3.2: è¨€èªé¸æŠãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold" data-i18n-label="review_language">
                                ãƒ¬ãƒ“ãƒ¥ãƒ¼è¨€èª
                            </label>
                            <select
                                class="form-select"
                                id="reviewLanguage"
                                name="review_language"
                            >
                                {% for lang in supported_languages %}
                                <option value="{{ lang['code'] }}" {% if lang['code'] == default_language %}selected{% end %}>
                                    {{ lang['native_name'] }}
                                </option>
                                {% end %}
                            </select>
                            <small class="form-text text-muted" data-i18n-label="select_language">
                                ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æŠ•ç¨¿ã™ã‚‹è¨€èªã‚’é¸æŠã—ã¦ãã ã•ã„
                            </small>
                        </div>

                        <!-- åœ¨è·çŠ¶æ³ -->
                        <div class="mb-4">
                            <label class="form-label fw-bold" data-i18n-label="employment_status"
                                >åœ¨è·çŠ¶æ³
                                <span class="text-danger" data-i18n-label="required">*</span></label
                            >
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input
                                            class="form-check-input"
                                            type="radio"
                                            name="employment_status"
                                            id="current"
                                            value="current"
                                            required
                                        />
                                        <label
                                            class="form-check-label"
                                            for="current"
                                            data-i18n-label="current_employee"
                                        >
                                            ç¾å¾“æ¥­å“¡
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input
                                            class="form-check-input"
                                            type="radio"
                                            name="employment_status"
                                            id="former"
                                            value="former"
                                            required
                                        />
                                        <label
                                            class="form-check-label"
                                            for="former"
                                            data-i18n-label="former_employee"
                                        >
                                            å…ƒå¾“æ¥­å“¡
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å‹¤å‹™æœŸé–“å…¥åŠ› -->
                        <div class="employment-period-section">
                            <div class="employment-period-title" data-i18n-label="employment_period">å‹¤å‹™æœŸé–“</div>
                            <!-- Task 4.3: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
                            <div id="employmentPeriodErrors" style="display: none;"></div>
                            <div class="period-inputs">
                                <select
                                    name="employment_start_year"
                                    id="employmentStartYear"
                                    class="period-select"
                                    data-i18n-placeholder="select_start_year"
                                >
                                    <option value="" data-i18n-placeholder="select_start_year">é–‹å§‹å¹´ã‚’é¸æŠ</option>
                                    <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
                                </select>
                                <span class="period-separator">ã€œ</span>
                                <select
                                    name="employment_end_year"
                                    id="employmentEndYear"
                                    class="period-select"
                                    data-i18n-placeholder="select_end_year"
                                >
                                    <option value="" data-i18n-placeholder="select_end_year">çµ‚äº†å¹´ã‚’é¸æŠ</option>
                                    <option value="present" data-i18n-label="present">ç¾åœ¨å‹¤å‹™</option>
                                    <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
                                </select>
                            </div>
                        </div>

                        <!-- è©•ä¾¡é …ç›® -->
                        {% for category in categories %}
                        <div class="mb-4 border rounded p-3">
                            <h5 class="mb-3">
                                {{ category['index'] }}. {{ category['title'] }}
                            </h5>
                            <p class="text-muted mb-3">
                                {{ category['question'] }}
                            </p>

                            <!-- è©•ä¾¡é¸æŠ -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">è©•ä¾¡</label>
                                <div class="row">
                                    {% for score in range(1, 6) %}
                                    <div class="col-2">
                                        <div class="form-check">
                                            <input
                                                class="form-check-input"
                                                type="radio"
                                                name="ratings[{{ category['key'] }}]"
                                                id="{{ category['key'] }}_{{ score }}"
                                                value="{{ score }}"
                                            />
                                            <label
                                                class="form-check-label"
                                                for="{{ category['key'] }}_{{ score }}"
                                            >
                                                {{ score }}ç‚¹
                                            </label>
                                        </div>
                                    </div>
                                    {% end %}
                                    <div class="col-2">
                                        <div class="form-check">
                                            <input
                                                class="form-check-input"
                                                type="radio"
                                                name="ratings[{{ category['key'] }}]"
                                                id="{{ category['key'] }}_no_answer"
                                                value="no_answer"
                                            />
                                            <label
                                                class="form-check-label"
                                                for="{{ category['key'] }}_no_answer"
                                            >
                                                å›ç­”ã—ãªã„
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ› -->
                            <div class="mb-2">
                                <label
                                    for="comment_{{ category['key'] }}"
                                    class="form-label fw-bold"
                                >
                                    ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆä»»æ„ï¼‰
                                </label>
                                <textarea
                                    class="form-control"
                                    id="comment_{{ category['key'] }}"
                                    name="comments[{{ category['key'] }}]"
                                    rows="3"
                                    maxlength="1000"
                                    placeholder="å…·ä½“çš„ãªçµŒé¨“ã‚„ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ï¼ˆæœ€å¤§1000æ–‡å­—ï¼‰"
                                ></textarea>
                                <div class="form-text">
                                    <span id="count_{{ category['key'] }}"
                                        >0</span
                                    >/1000æ–‡å­—
                                </div>
                            </div>
                        </div>
                        {% end %}

                        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º -->
                        <div class="mb-4">
                            <h5>ãƒ¬ãƒ“ãƒ¥ãƒ¼ç‚¹æ•°ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h5>
                            <div class="bg-light p-3 rounded">
                                <div class="row align-items-center">
                                    <div class="col-md-8">
                                        <span class="fw-bold"
                                            >ã‚ãªãŸã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ç‚¹æ•°:
                                        </span>
                                        <span
                                            id="previewRating"
                                            class="h4 text-warning"
                                            >-.-</span
                                        >
                                        <small class="text-muted"
                                            >ï¼ˆ<span id="answeredCount">0</span
                                            >é …ç›®å›ç­”ï¼‰</small
                                        >
                                    </div>
                                    <div class="col-md-4 text-end">
                                        <small class="text-muted"
                                            >å›ç­”ã—ãŸé …ç›®ã®å¹³å‡ç‚¹</small
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Task 6.3: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ -->
                        <input type="hidden" name="mode" id="formMode" value="preview" />
                        <div class="d-flex justify-content-between">
                            <a
                                href="/companies/{{ company['id'] }}"
                                class="btn btn-secondary"
                                >ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a
                            >
                            <button
                                type="submit"
                                class="btn btn-primary btn-lg"
                                id="submitBtn"
                                disabled
                            >
                                ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ â†’
                            </button>
                        </div>
                    </form>
                    {% end %}
                </div>
            </div>

            <!-- æ³¨æ„äº‹é … -->
            {% if not show_login_panel %}
            <div class="mt-4">
                <div class="alert alert-info">
                    <h6>
                        <i class="bi bi-info-circle"></i> æŠ•ç¨¿ã«é–¢ã™ã‚‹æ³¨æ„äº‹é …
                    </h6>
                    <ul class="mb-0">
                        <li>åŒã˜ä¼šç¤¾ã¸ã®æŠ•ç¨¿ã¯1å¹´é–“ã«1å›ã¾ã§ã§ã™</li>
                        <li>æŠ•ç¨¿ã‹ã‚‰1å¹´ä»¥å†…ã§ã‚ã‚Œã°ã€å†…å®¹ã‚’ç·¨é›†ã§ãã¾ã™</li>
                        <li>ã™ã¹ã¦ã®é …ç›®ã¸ã®å›ç­”ã¯å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“</li>
                        <li>å…·ä½“çš„ã§å»ºè¨­çš„ãªã‚³ãƒ¡ãƒ³ãƒˆã‚’ãŠé¡˜ã„ã—ã¾ã™</li>
                    </ul>
                </div>
            </div>
            {% end %}
        </div>
    </div>
</div>

{% if not show_login_panel %}
<!-- Task 3.3, 4.1, 4.3: reviewForm.js ã®èª­ã¿è¾¼ã¿ -->
<script src="/static/js/reviewForm.js"></script>
<script>
    // Task 3.2: ç¿»è¨³è¾æ›¸ã‚’JavaScriptã§åˆ©ç”¨å¯èƒ½ã«ã™ã‚‹
    const translations = {{ translations }};

    document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("reviewForm");
        const submitBtn = document.getElementById("submitBtn");
        const previewRating = document.getElementById("previewRating");
        const answeredCount = document.getElementById("answeredCount");

        // Task 3.3: ReviewFormã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
        const reviewForm = new ReviewForm(translations);

        // Task 3.3: ãƒ–ãƒ©ã‚¦ã‚¶è¨€èªã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨€èªã‚’è¨­å®š
        const defaultLang = reviewForm.detectBrowserLanguage();
        const languageSelect = document.getElementById('reviewLanguage');
        if (languageSelect && !languageSelect.value) {
            languageSelect.value = defaultLang;
        }
        reviewForm.switchLanguage(languageSelect ? languageSelect.value : defaultLang);

        // Task 3.3: è¨€èªé¸æŠã®å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
        if (languageSelect) {
            languageSelect.addEventListener('change', function() {
                reviewForm.switchLanguage(this.value);
            });
        }

        // å‹¤å‹™æœŸé–“ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã®åˆæœŸåŒ–
        initializeEmploymentPeriodDropdowns();

        // æ–‡å­—ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½
        document
            .querySelectorAll('textarea[name^="comments"]')
            .forEach((textarea) => {
                const category = textarea.name.match(/comments\[(\w+)\]/)[1];
                const counter = document.getElementById(`count_${category}`);

                textarea.addEventListener("input", function () {
                    counter.textContent = this.value.length;
                });
            });

        // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¨ˆç®—
        function updatePreview() {
            const ratings = [];
            let hasEmploymentStatus = false;

            // åœ¨è·çŠ¶æ³ãƒã‚§ãƒƒã‚¯
            const employmentStatus = form.querySelector(
                'input[name="employment_status"]:checked',
            );
            hasEmploymentStatus = !!employmentStatus;

            // è©•ä¾¡ç‚¹æ•°ã‚’åé›†
            document
                .querySelectorAll('input[name^="ratings"]:checked')
                .forEach((radio) => {
                    if (radio.value !== "no_answer") {
                        ratings.push(parseInt(radio.value));
                    }
                });

            // å¹³å‡ç‚¹è¨ˆç®—
            if (ratings.length > 0) {
                const average =
                    ratings.reduce((sum, rating) => sum + rating, 0) /
                    ratings.length;
                previewRating.textContent = average.toFixed(1);
                answeredCount.textContent = ratings.length;
            } else {
                previewRating.textContent = "-.-";
                answeredCount.textContent = "0";
            }

            // æŠ•ç¨¿ãƒœã‚¿ãƒ³ã®æœ‰åŠ¹/ç„¡åŠ¹åˆ¶å¾¡
            submitBtn.disabled = !hasEmploymentStatus || ratings.length === 0;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        form.addEventListener("change", updatePreview);

        // åˆæœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
        updatePreview();

        // å‹¤å‹™æœŸé–“ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã®åˆæœŸåŒ–é–¢æ•°
        function initializeEmploymentPeriodDropdowns() {
            const currentYear = new Date().getFullYear();
            const startYear = 1970;

            const startYearSelect = document.getElementById(
                "employmentStartYear",
            );
            const endYearSelect = document.getElementById("employmentEndYear");

            // é–‹å§‹å¹´ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’ç”Ÿæˆï¼ˆ1970å¹´ã‹ã‚‰ç¾åœ¨å¹´ã¾ã§ï¼‰
            for (let year = currentYear; year >= startYear; year--) {
                const option = document.createElement("option");
                option.value = year;
                option.textContent = year + "å¹´";
                startYearSelect.appendChild(option);
            }

            // çµ‚äº†å¹´ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’ç”Ÿæˆï¼ˆ1970å¹´ã‹ã‚‰ç¾åœ¨å¹´ã¾ã§ï¼‰
            // ã€Œç¾åœ¨å‹¤å‹™ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ—¢ã«HTMLã«å­˜åœ¨
            for (let year = currentYear; year >= startYear; year--) {
                const option = document.createElement("option");
                option.value = year;
                option.textContent = year + "å¹´";
                endYearSelect.appendChild(option);
            }

            // é–‹å§‹å¹´å¤‰æ›´æ™‚ã®çµ‚äº†å¹´åˆ¶é™ãƒ­ã‚¸ãƒƒã‚¯
            startYearSelect.addEventListener("change", function () {
                const selectedStartYear = parseInt(this.value);
                if (selectedStartYear) {
                    updateEndYearOptions(selectedStartYear, endYearSelect);
                }
            });
        }

        function updateEndYearOptions(startYear, endYearSelect) {
            const currentYear = new Date().getFullYear();

            // æ—¢å­˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆã€Œç¾åœ¨å‹¤å‹™ã€ä»¥å¤–ï¼‰ã‚’ã‚¯ãƒªã‚¢
            const currentOption = endYearSelect.querySelector(
                'option[value="current"]',
            );
            const emptyOption = endYearSelect.querySelector('option[value=""]');

            endYearSelect.innerHTML = "";
            if (emptyOption) endYearSelect.appendChild(emptyOption);
            if (currentOption) endYearSelect.appendChild(currentOption);

            // é–‹å§‹å¹´ä»¥é™ã®å¹´æ•°ã®ã¿ã‚’è¿½åŠ 
            for (let year = currentYear; year >= startYear; year--) {
                const option = document.createElement("option");
                option.value = year;
                option.textContent = year + "å¹´";
                endYearSelect.appendChild(option);
            }
        }

        // Task 4.1: é›‡ç”¨çŠ¶æ…‹é¸æŠæ™‚ã®è‡ªå‹•å…¥åŠ›ã‚µãƒãƒ¼ãƒˆ
        const currentRadio = document.getElementById('current');
        const formerRadio = document.getElementById('former');
        const endYearSelect = document.getElementById('employmentEndYear');

        if (currentRadio && formerRadio && endYearSelect) {
            currentRadio.addEventListener('change', function() {
                if (this.checked) {
                    reviewForm.handleEmploymentStatusChange('current', endYearSelect);
                }
            });

            formerRadio.addEventListener('change', function() {
                if (this.checked) {
                    reviewForm.handleEmploymentStatusChange('former', endYearSelect);
                }
            });
        }

        // Task 4.3: ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        const errorContainer = document.getElementById('employmentPeriodErrors');

        form.addEventListener("submit", function (e) {
            const employmentStatus = form.querySelector(
                'input[name="employment_status"]:checked',
            );
            const hasAnyRating =
                form.querySelectorAll('input[name^="ratings"]:checked').length >
                0;

            if (!employmentStatus) {
                alert("åœ¨è·çŠ¶æ³ã‚’é¸æŠã—ã¦ãã ã•ã„");
                e.preventDefault();
                return;
            }

            if (!hasAnyRating) {
                alert("å°‘ãªãã¨ã‚‚1ã¤ã®é …ç›®ã«è©•ä¾¡ã‚’ã¤ã‘ã¦ãã ã•ã„");
                e.preventDefault();
                return;
            }

            // Task 4.3: é›‡ç”¨æœŸé–“ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
            if (!reviewForm.validateOnSubmit(form, errorContainer)) {
                e.preventDefault();
                return;
            }
        });
    });
</script>
{% end %} {% end %}
